{% extends "base.html" %}

{% block title %}Dashboard - AML Detection Platform{% endblock %}

{% block content %}
<div class="dashboard">
    <!-- KPI Cards -->
    <div class="kpi-section">
        <div class="kpi-grid">
            <div class="kpi-card suspicious">
                <div class="kpi-icon">
                    <i class="fas fa-exclamation-triangle"></i>
                </div>
                <div class="kpi-content">
                    <h3 id="suspicious-transactions">0</h3>
                    <p>Suspicious Transactions</p>
                    <span class="kpi-change positive" id="suspicious-change">+0%</span>
                </div>
            </div>
            
            <div class="kpi-card accounts">
                <div class="kpi-icon">
                    <i class="fas fa-users"></i>
                </div>
                <div class="kpi-content">
                    <h3 id="monitored-accounts">0</h3>
                    <p>Monitored Accounts</p>
                    <span class="kpi-change positive" id="accounts-change">+0%</span>
                </div>
            </div>
            
            <div class="kpi-card risk-rate">
                <div class="kpi-icon">
                    <i class="fas fa-chart-line"></i>
                </div>
                <div class="kpi-content">
                    <h3 id="daily-risk-rate">0%</h3>
                    <p>Daily Risk Rate</p>
                    <span class="kpi-change negative" id="risk-change">0%</span>
                </div>
            </div>
            
            <div class="kpi-card cash-flow">
                <div class="kpi-icon">
                    <i class="fas fa-coins"></i>
                </div>
                <div class="kpi-content">
                    <h3 id="cash-flow-volume">$0</h3>
                    <p>Cash Flow Volume</p>
                    <span class="kpi-change positive" id="volume-change">+0%</span>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Main Dashboard Grid -->
    <div class="dashboard-grid">
        <!-- Geographic Map -->
        <div class="dashboard-card map-card">
            <div class="card-header">
                <h2><i class="fas fa-globe"></i> Global Cash Flow Map</h2>
                <div class="card-controls">
                    <div class="control-group">
                        <label for="map-currency">Currency:</label>
                        <select id="map-currency" class="control-select">
                            <option value="ALL">All Currencies</option>
                            <option value="USD">USD</option>
                            <option value="EUR">EUR</option>
                            <option value="GBP">GBP</option>
                            <option value="JPY">JPY</option>
                            <option value="CHF">CHF</option>
                            <option value="CAD">CAD</option>
                        </select>
                    </div>
                    
                    <div class="control-group">
                        <label for="map-period">Period:</label>
                        <select id="map-period" class="control-select">
                            <option value="7d">Last 7 Days</option>
                            <option value="30d" selected>Last 30 Days</option>
                            <option value="90d">Last 90 Days</option>
                            <option value="180d">Last 6 Months</option>
                            <option value="365d">Last Year</option>
                        </select>
                    </div>
                    
                    <div class="control-group">
                        <label for="map-min-amount">Min Amount:</label>
                        <select id="map-min-amount" class="control-select">
                            <option value="0">All Amounts</option>
                            <option value="10000">$10K+</option>
                            <option value="100000">$100K+</option>
                            <option value="1000000" selected>$1M+</option>
                            <option value="10000000">$10M+</option>
                        </select>
                    </div>
                    
                    <div class="control-group">
                        <label for="map-risk-level">Risk Level:</label>
                        <select id="map-risk-level" class="control-select">
                            <option value="all" selected>All Levels</option>
                            <option value="high">High Risk Only</option>
                            <option value="medium">Medium Risk Only</option>
                            <option value="low">Low Risk Only</option>
                        </select>
                    </div>
                    
                    <div class="control-group">
                        <button id="apply-map-filters" class="btn btn-sm btn-success">
                            <i class="fas fa-filter"></i> Apply Filters
                        </button>
                        <button id="reset-map-filters" class="btn btn-sm btn-secondary">
                            <i class="fas fa-undo"></i> Reset
                        </button>
                        <button id="refresh-map" class="btn btn-sm btn-primary">
                            <i class="fas fa-sync"></i> Refresh
                        </button>
                    </div>
                </div>
            </div>
            <div class="card-content">
                <!-- Filter Statistics -->
                <div class="map-filter-stats">
                    <div class="filter-stat">
                        <span class="stat-value">0</span>
                        <span class="stat-label">Locations</span>
                    </div>
                    <div class="filter-stat">
                        <span class="stat-value">0</span>
                        <span class="stat-label">Flows</span>
                    </div>
                    <div class="filter-stat">
                        <span class="stat-value">$0M</span>
                        <span class="stat-label">Total Volume</span>
                    </div>
                </div>
                
                <div id="world-map" class="map-container"></div>
                <div class="map-legend">
                    <div class="legend-item">
                        <div class="legend-color high-risk"></div>
                        <span>High Risk</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color medium-risk"></div>
                        <span>Medium Risk</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color low-risk"></div>
                        <span>Low Risk</span>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Risk Distribution Chart -->
        <div class="dashboard-card chart-card">
            <div class="card-header">
                <h2><i class="fas fa-chart-pie"></i> Risk Distribution</h2>
            </div>
            <div class="card-content">
                <canvas id="risk-distribution-chart"></canvas>
            </div>
        </div>
        
        <!-- Recent Alerts -->
        <div class="dashboard-card alerts-card">
            <div class="card-header">
                <h2><i class="fas fa-bell"></i> Recent Alerts</h2>
                <a href="{{ url_for('alerts') }}" class="btn btn-sm btn-outline">View All</a>
            </div>
            <div class="card-content">
                <div id="recent-alerts" class="alerts-list">
                    <!-- Alerts will be loaded here -->
                </div>
            </div>
        </div>
        
        <!-- Top Risky Accounts -->
        <div class="dashboard-card accounts-card">
            <div class="card-header">
                <h2><i class="fas fa-user-shield"></i> High-Risk Accounts</h2>
            </div>
            <div class="card-content">
                <div id="risky-accounts" class="accounts-list">
                    <!-- Accounts will be loaded here -->
                </div>
            </div>
        </div>
          <div class="dashboard-card currency-card">
            <div class="card-header">
                <h2><i class="fas fa-coins"></i> Currency Breakdown</h2>
            </div>
            <div class="card-content">
                <div id="currency-breakdown" class="currency-list">
                    <!-- Currency data will be loaded here -->
                </div>
            </div>
        </div>
        <!-- Transaction Volume Chart -->
        <div class="dashboard-card chart-card wide">
            <div class="card-header">
                <h2><i class="fas fa-chart-area"></i> Transaction Volume Trends</h2>
                <div class="card-controls">
                    <select id="volume-period" class="control-select">
                        <option value="24h">Last 24 Hours</option>
                        <option value="7d" selected>Last 7 Days</option>
                        <option value="30d">Last 30 Days</option>
                    </select>
                </div>
            </div>
            <div class="card-content">
                <!-- Volume Summary Stats -->
                <div id="volume-summary" class="volume-summary">
                    <!-- Volume statistics will be loaded here -->
                </div>
                
                <!-- Chart Canvas -->
                <div class="volume-trend-container">
                    <canvas id="volume-trend-chart"></canvas>
                </div>
            </div>
        </div>
        
        <!-- Currency Breakdown -->
      
    </div>
</div>

<!-- Quick Actions Panel -->
<div class="quick-actions">
    <button id="run-ai-analysis" class="action-btn analysis">
        <i class="fas fa-brain"></i>
        <span>Run AI Analysis</span>
    </button>
    <button id="export-report" class="action-btn export">
        <i class="fas fa-download"></i>
        <span>Export Report</span>
    </button>
    <button id="create-alert" class="action-btn alert">
        <i class="fas fa-plus"></i>
        <span>Create Alert</span>
    </button>
</div>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
{% endblock %}